!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);let i,o,a=null,r=null,s=null,d=null,c=null;const l=e=>new Promise((t,n)=>{let i;setTimeout(()=>{i||(i=!0,n("TIMEOUT"))},3500);navigator.mediaDevices.getUserMedia(e).then((function(e){i||(i=!0,a.srcObject=e,a.setAttribute("playsinline",!0),a.setAttribute("controls",!0),setTimeout(()=>{document.querySelector("video").removeAttribute("controls")}),t())})).catch(e=>{i||(i=!0,n(e))})}),u=e=>{s.width=window.innerWidth,s.height=window.innerHeight,setTimeout(()=>{try{d.drawImage(e,0,0,s.width,s.height);var t=d.getImageData(0,0,s.width,s.height);t.data&&c.postMessage(t)}catch(t){"NS_ERROR_NOT_AVAILABLE"==t.name&&setTimeout(()=>u(e),0)}},1)};var g=e=>(a=document.getElementById("video"),r=document.getElementById("image"),s=document.createElement("canvas"),d=s.getContext("2d"),c=new Worker("decoder.js"),e&&window.isMediaStreamAPISupported?navigator.mediaDevices.enumerateDevices().then((function(e){const t=e.filter((function(e){if("videoinput"==e.kind)return e}));let n;if(t.length){o=t.length-1;const e=t[o];i=e.deviceId,n=i?{video:{mandatory:{sourceId:i||null}},audio:!1}:{video:!0},window.iOS&&(n.video.facingMode="environment")}else i=void 0,o=void 0,n={video:!0};return l(n).then(()=>({devices:t.map(e=>e.label),selected:o})).catch(()=>({devices:t.map(e=>e.label),selected:o}))})).catch((function(){return!1})):Promise.resolve(!1)),m=(e,t)=>{c.onmessage=function(n){if(n.data.length>0){var i=n.data[0][2];t(i)}setTimeout((function(){u(a)}),e||1)},u(a)},v=e=>{c.onmessage=function(t){if(t.data.length>0){var n=t.data[0][2];e(n)}else e(null)},u(r)},f=()=>navigator.mediaDevices.enumerateDevices().then((function(e){const t=e.filter((function(e){if("videoinput"==e.kind)return e}));let n,a=i&&t[o]&&t[o].deviceId===i&&t[o];if(i&&!a){for(let e=0;e<t.length;e++)if(t[e].deviceId===i){a=t[e],o=e;break}a||(a=t[o])}return a?(o=(o+1)%t.length,a=t[o],i=a.deviceId):t.length&&(o=0,a=t[0],i=a.deviceId),a?(n={video:{mandatory:{sourceId:i||null}},audio:!1},window.iOS&&(n.video.facingMode="environment")):(i=void 0,o=void 0,n={video:!0}),l(n).then(()=>({devices:t.map(e=>e.label),selected:o}))}));n(1);window.addEventListener("DOMContentLoaded",()=>{window.iOS=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0,window.isMediaStreamAPISupported=navigator&&navigator.mediaDevices&&"enumerateDevices"in navigator.mediaDevices,window.noCameraPermission=!1,window.addEventListener("load",()=>{g(!0).then((function(e){const t=Boolean(e);setTimeout(()=>{const n=document.getElementsByTagName("html")[0];if(t)m(250,e=>{parent.postMessage({event:"scan-result",result:e},location.origin)}),window.addEventListener("message",(function(e){e.origin===location.origin&&e.data&&"next-device"===e.data.command&&f().then(e=>{parent.postMessage({event:"next-device-result",success:!0,error:!1,...e},location.origin)}).catch(e=>{parent.postMessage({event:"next-device-result",success:!1,error:!0,errorMessage:e.message},location.origin)})}),!1),parent.postMessage({event:"init-status",...e,streaming:!0,single:!1},location.origin),n.className="streaming";else{var i=(o=document.getElementById("input-file"),a=document.getElementById("image"),(r=document.getElementById("single-frame")).style.backgroundImage="none",o.addEventListener("change",e=>{if(e.target&&e.target.files.length>0){const t=URL.createObjectURL(e.target.files[0]);r.style.backgroundImage="url('"+t+"')",a.src=t,v(e=>{parent.postMessage({event:"scan-result",result:e},location.origin)})}}),o.click.bind(o));window.addEventListener("message",(function(e){e.origin===location.origin&&e.data&&"scan"===e.data.command&&i()}),!1),parent.postMessage({event:"init-status",streaming:!1,single:!0},location.origin),n.className="single"}var o,a,r},1e3)}))})})},function(e,t){}]);